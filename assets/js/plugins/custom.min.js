$(document).ready(function () {
    // التأكد من عدم إعادة تهيئة الجدول إذا كان مهيأ مسبقًا
    if ($.fn.DataTable.isDataTable('#left-right-fix')) {
        $('#left-right-fix').DataTable().destroy();
    }

    var table = $('#left-right-fix').DataTable({
        "language": {
            "info": "عرض _START_ إلى _END_ من _TOTAL_ مدخلات",
            "infoEmpty": "عرض 0 إلى 0 من 0 مدخلات",
            "lengthMenu": "عرض _MENU_ مدخلات",
            "search": "بحث:",
            "paginate": {
                "first": "الأول",
                "last": "الأخير",
                "next": "التالي",
                "previous": "السابق"
            }
        },
        scrollY: '55vh',
        scrollX: true,
        "searchable": false,
        scrollCollapse: false,
        paging: false,
        fixedColumns: {
            leftColumns: 1,
            rightColumns: 1
        },
        initComplete: function () {
            this.api().columns().every(function () {
                let column = this;
                let title = column.footer() ? column.footer().textContent : '';

                // إنشاء حقل إدخال للبحث
                let input = document.createElement('input');
                input.placeholder = title;

                if (column.footer()) {
                    column.footer().replaceChildren(input);
                }

                // إضافة استماع لحدث الإدخال
                input.addEventListener('keyup', function () {
                    if (column.search() !== this.value) {
                        column.search(this.value).draw();
                    }
                });
            });
        }
    });

    // تفعيل التحرير المباشر باستخدام X-editable
    $('.editable').editable({
        url: '/update-data', // Replace with your server endpoint to handle updates
        mode: 'inline', // Inline editing mode
        emptytext: 'فارغ', // Default text when the value is empty
        params: function(params) {
            // Add additional parameters if needed
            return params;
        },
        success: function(response, newValue) {
            // Handle success response from the server
            console.log('Updated successfully:', newValue);
        },
        error: function(response, newValue) {
            // Handle error response from the server
            console.error('Error updating:', response);
        }
    });


});

